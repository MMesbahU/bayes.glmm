---
title: "An introduction to Bayes.Glmm"
author: "Xulong Wang"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{An introduction to Bayes.Glmm}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

Vignettes are long form documentation commonly included in packages. Because they are part of the distribution of the package, they need to be as compact as possible. The `html_vignette` output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format:

- Never uses retina figures
- Has a smaller default figure size
- Uses a custom CSS stylesheet instead of the default Twitter Bootstrap style

```{r, include = F}

library(rstan)
library(bayes.glmm)

```

```{r}

setwd("~/Dropbox/GitHub/bayes.glmm")

data("sample")

Ad = data$pheno
geno = data$geno

cov = data$cov

K = data$K
L <- t(chol(K))

model = stan_models("glm")

config0 = list(chains = 3, iter = 400, warmup = 200, cores = 3)

g0 = rep(0, 576)
data0 = list(N = 576, K = 4, D = 2, cov = cov, L = L, g = g0, Ad = Ad)

y = myGWAS_optimizing(model = model, geno = geno[1:5, ], data0)
# y = myGWAS_sampling(model = model, geno = geno[1:5, ], data0, config0)

```
